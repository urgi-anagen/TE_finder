#
# Global definitions and rules for TE_finder
#

VERSION = "2.27"

OS := $(shell uname)

#Compiler call
CXX = $(CC)
#CXX = gcc

#Compiler parameters
#CXXFLAG = -Wall -std=gnu++11 -DVERSION=$(VERSION) -DOS=$(OS) -D_REENTRANTT
#CXXFLAG = -Wall -pthread -std=c++11  -DVERSION=$(VERSION) -DOS=$(OS) -D_REENTRANT
#CXXFLAG = -O3 -Wall -pthread -std=c++11  -DVERSION=$(VERSION) -DOS=$(OS) -D_REENTRANT
CXXFLAG = -ggdb -Wall -pthread -std=c++11  -DVERSION=$(VERSION) -DOS=$(OS) -D_REENTRANT

LDFLAG =

BASE = ..

SDG_LIB = $(BASE)/SDGlib
SDG_HEADERS= $(BASE)/SDGlib

DGE_LIB = $(BASE)/DGElib
DGE_HEADERS= $(BASE)/DGElib

BLR_LIB = $(BASE)/BLRlib
BLR_HEADERS= $(BASE)/BLRlib

OBJ_LIB=$(SDG_LIB)/libsdg.a $(DGE_LIB)/libDGE.a  $(BLR_LIB)/libBLR.a

INCLUDE = -I. -I$(SDG_HEADERS) -I$(DGE_HEADERS) -I$(BLR_HEADERS) 
LIB = -L. -L$(SDG_LIB) -L$(DGE_LIB) -L$(BLR_LIB) 
LINK = -lBLR -lDGE -lsdg -lstdc++ -lm -lcppunit

TAR = tar
LN = ln -f
AR = ar

OBJ = 

SOURCES = *.cpp 

.SUFFIXES: .o .h .cpp .c

%.o : %.cpp
	$(CXX) -c $(CXXFLAG) -MD $(INCLUDE) -DVERSION=$(VERSION) -o $@ $<
	@cp $*.d $*.P; \
	sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\$$//' \
	    -e '/^$$/ d' -e 's/$$/ :/' < $*.d >> $*.P; \
	rm -f $*.d

	$(CXX) -c $(CXXFLAG) $(INCLUDE) -pthread -o $@ $<

-include $(SOURCES:%.cpp=$(DEPDIR)/%.P)
